name: 'TestAgent'

on: 
  workflow_dispatch:
    inputs:
      logLevel:
        description: 'Log level'     
        required: true
        default: 'warning' 

jobs:
  printInputs:
    runs-on: ubuntu-latest
    steps:
    - shell: bash
      run: |
        echo "Log level: ${{ github.event.inputs.logLevel }}"
        echo ${{ secrets.C8YCERT }} > piCert.pem
        echo ${{ secrets.C8YKEY }} > piCertKey.pem
        echo "[device]
        name = Pi
        host = mqtt.eu-latest.cumulocity.com
        port = 8883
        tls = true
        cert_auth = true
        client_cert = piCert.pem
        client_key = piCertKey.pem
        cacert = /etc/ssl/certs/ca-certificates.crt
        operations = c8y_Restart,c8y_Message,c8y_Configuration,c8y_SendConfiguration,c8y_RemoteAccessConnect,c8y_SoftwareList
        subscribe = s/ds,s/dc/pi,s/e,s/dt
        devicetype = c8y_Pi
        sendinterval = 5
        requiredinterval = 10
        loglevel = DEBUG
        reboot = 0
        config_update = 0
        bootstrap_pwd = Fhdt1bb1f
        serial=0000000070596700" > pi.properties
        cat pi.properties
        
